sudo: required
services:
- docker
os:
- linux
script:
- echo ${TRAVIS_COMMIT}
env:
  global:
  - COMMIT=${TRAVIS_COMMIT}
  - secure: t4PPfZ20rxIsrYAhsBerxe+GjesXUmcAuvVI8pzG5017yIv4G5JIB4Mzne5nT6jMi2p7w1T94c3zesDPyqK0OaXu/YsUqr+4UpU0+Zvz1YW2mcPwzIkWMSeKsf67LfWxixdhjq9DwhfRPYKhRW+a0zt/hGN7wLnYvMdnQn+XoLj5rv7DIZ8zN3uPw9dVDStN+1Pm08meo3q9zQu2Zi9NUUz4TyF3VWkMxKFqR/bBmeX+HV6NUslBgY9UwjDjMvlXZZrKVzWP2Vc+dN84cy7fzILXeqQScvrgg1y5yH9kAF0SpHmS43n9I/hrii9MBy54TPhm2P+BR5Wl/AUM8Nw2mprLx4l+I/yF9dR+hOCKIoNzbeobZkxNo8W5f2FLkXKmrwvXtQr9ojKiVLEsCignxATdfx4k90KsjH/tK6Jp8hhgkEK3STJCZNJj/O37GkEhhoD9Wko7A+1+oMykUa5pZ6VtRxIxERGY978TRercKYsWuSH6JzJhfZUqhBBU1RsZ9ZClUl2ql8iu8zlH14+GEh2T34WZLSfaxlBtGU9Qp/Kalouf7TXeLhxPhj2Rn+hZHHfklcJ5UDJ442kjsZeWSj9QLqLTUrfrPAB7eJnMcs+UgGEp+NfeBg4jxWsyj93jk9lOnIhcq6EgeNWNMIMvY8bfeCUopChI26NsNJVYqC0=
  - secure: G25hHQnWLuGHK2WlE2qZpKT1SqiwRni3Dp7qXT/NwLJ68uqLhYsiSqm/z9q5+kavRheuHoyx09uscLQI5qmt5JLPhwme0ILUQVrREL6TatJPheJ6OAYyAVFgCK9kV+rSoQJ2A1qNtFrMizCkbdScgR27MwzNnQyl3YVYcAtUlzoiIDkLOFKecGnjZajeTGm1ok4xlLTqr/e7JGC/o3OwREJhyljBAy7UcFSDpTnoB1ABAfNop9/wEWsnUKxGvKIumZfN25rxyTNlxS4AtMdSAmUdr11un5eOQX7UbW+6l6O1TwotkOvwmj8R5sVAm+3AC/JOhATBgs0RX0dEdQPKidg9Bo2H6+kTFTAmmirJEQBJI94VtU+ndYLESbz+U0eOqhUWfmn0PxV3NmvK0ciGI8kl5sDxaxWT8iyB9cZ4HtcOUgbWAt+PAL34NUWcLMWo4g78yu4xl9Ccczpb7m2uoMRKh2NwUugROd6O5fj7mKamv7NdCvjPGj3ZGINARjZ+v9DDNc0ZDRJkIWS7qWqEzfqWS9kMZOwM43o+1Vvy568Ve6JQEnd9kdwokRSP8NqgIZbV9VMNL/fESvlhWMfdTF5TLFmf5KiJRuAMXTRwWl8B7Dhic8qEXDoJSQ1vJad4RTEbw5CSCxakR9hLDlHGyaeApEiUKmHH5xHrRcntAtE=
  - secure: xjEcCELrg6mxF+Z22WMtPq4e6J2FO6YRLGEmjaPzifbr/2rb068HK+VYdvU/MZoUC7VsWcUwamNqpP0I9QJqaBdBzDFZLVc5tbHl8z0H0DUXNb0Ux0AlAYZRKMhHntiWUe4cLkYZABwM8iHTliYJNHBVsEEfLYETzcEgQPLfKqFeIH3GLlTxiZTOGV/TSaySL7ZclEDBhoDcPmQaXOVcneNultn5iR0RVgIGh+G6gUXni3D6oUS/mr0XCU57ncMCtUp1UT7q2C0iO7dQAJF0iNNsz0nVoDKsSx8pQGHuCEgBRoMtUG+16H2QsFv7qFv/XFN94EdW/HnRh5LxNtl5LTMwRBWLeMWRgSpqBueCry0RLrBj0oU/A3QytOxzpud0sO2ifjGWVnlj0+LwFFe7o2Z316bGKXGMjEo/GG8yHtrAzvP/+HotqtstUOcP3A3hRnqkIf80bx9BbWdNu4qWyiSRgYFCJF0EHSprdY8CDmD3zx68yGvmgzDmqm5JbB8/88sUyvzip3i5EzXO3bIHT24EwFscngx4hW78Ke2zp2ZeIwBMU0913VLCgGsgW8M9UdnbeN9jpU4CYgGvJg63i1C/SWlfhZiQoNIRECU3jstMnlQpztUs5ukV0JWQmRuSaSwpijNFZoibLfeCtpCjofyz1ePkW6nW+IAP6szqzks=
  - secure: u2CeJprWZZ/ElYByHfgw6IxRm5bCl4Ty6UIqojwsV67phcXICRz6cnOJr1b1oi0LnJZxRmWrCuESqQir97hWj73vvGiePq6HkC/IvGvkMvRj5q17GFuNO2ujvxDcGqf8ZwP/uGfC/LnxBzQ7HVmpdtPhWdcWSQcxOWTzHi43MHidoXZ/ptS5fgd4qzujHi9vfWdtUHaUoOPRx87vhiG7VLtaGwSXvVFXfaD+tyldNdjoD+h0Mp0CGhx6NCugiGKxcU+ktMQK/HoWO/lgC+Dp8M50WbGhO96mx3luqOInMGuBKbnMTW9K+K0Me9WWkHq8PVGmyCqUWQ/2sbSdFVOEasSESDdeqvGRVrC32/AEJG2qAywQaY6cj3BuQWLYWxn8HtZh7J9wEVFtCpJTV+EQl3ulslq3jryAc5ycCc85PyKYlDyyZ+GWp2vZJZX9wgCRJp7PoBUiESJxJnbYpi6GHy6oW6Iuu5fMYxfWpYYLj+2Ih7QAwmyySKiBAIWtvCv4REXzwrIV8E8xrBDLv9466naDqNYVkm0s1D3ShSXmahsz5inOAzv1e3y/vTeaKl5z11Xwb7Jbwy2AwKu9LNEPc+OF5tHgz1g/z0L1DIlxORMENbqBxvaRqGmwqkPS96lvLqMhM58SuNlw6PSwCdKwDe3oiCWj2hvRVbXDlv9kc+c=
  - secure: wzHf/G8JqpfYVrwDOgH5Yz3e9ijmngjvzUKEtJPwebiso7gPxelM+aUv6P3kLsLlXDUYNmq/iud5PYN6e73MiUVibnQQNTOeOFfW3v03qiM38HORbE627JP0ZWYz6vnlewzJjdRSucVbPZWI8vQ9yrSD2dLUs7FZK092fsi2Npi0VY4ziqfSntZYUU2DErP5EugHS6ro4pdjPlcZ8hDBV7OnZdyfYwy2fhOHqFaXRliENLd/cxhIVJnjnD+IfmFZMKNPvlOv7pK605pKjfB554BfxYaQK5lvxcVtr5I7XrRm0/YPP9fuYxqim/CzTjS1nWahWTA22jQkIqwr1LUMBKmsPMx+YdkRDvlScLIuPgiHYI/YCmVIEYfDa1VyIl9p/nt6J76m+QoXlgS6u1y37wdQ2RxehqY1O29yN4vIDSOJXfCfP5X2yvrO7tVSK+40g7gZny0GFkwyMPJhXAG5BYxpw5rIEiNy8C7FSKEIzz9F/X49jgZ2xB/HGFzMOwvGVA00XVf9Nq4+Yi8fx1Tp4pHlS/8m6tNRI6qV24lSLkBkGbWVCvmSKKEF2yT5TxlhKTtLW18swNl7ThW7tzRjrYEE6F3CKvXahhd8v2hgyWV/ASGPXsCt4ZWdf+azqcZBRMGPo4Bp+W9crsOK3HTQHsz+zG7w5dV59phQIUaYy4c=
script:
- docker login -u $DOCKER_USER -p $DOCKER_PASS
- export REPO=dougefresh/docker-passwd-pot
- docker build -f Dockerfile -t $REPO:$COMMIT .
- docker tag $REPO:$COMMIT $REPO:$COMMIT
- docker push $REPO:$COMMIT
- bash ./deploy.sh eu-central-1  dougefresh/docker-passwd-pot:$COMMIT
- bash ./deploy.sh ca-central-1  dougefresh/docker-passwd-pot:$COMMIT
- bash ./deploy.sh us-east-2  dougefresh/docker-passwd-pot:$COMMIT
- bash ./deploy.sh us-west-2  dougefresh/docker-passwd-pot:$COMMIT
